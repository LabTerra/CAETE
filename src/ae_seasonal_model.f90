! =============================================================================
! Available Energy Seasonal Model for CAETE
! =============================================================================
!
! Generated from NCEP-NCAR Reanalysis 1 data (1991-2020 Long-Term Mean)
! Region: Pan Amazon (-21.5°N to 10.5°N,
!                     -80.0°E to -43.0°E)
!
! Models:
!   Global:  AE = 0.559775 × T + 123.063058  (R² = 0.0157)
!   Monthly: 12 sets of slope/intercept pairs
!   Daily:   365 sets of slope/intercept pairs
!
! Usage:
!   use ae_seasonal_model
!   real(r_8) :: temp_celsius, ae
!   integer :: month, doy
!
!   ae = available_energy_global(temp_celsius)
!   ae = available_energy_monthly(temp_celsius, month)
!   ae = available_energy_daily(temp_celsius, doy)
!
! Author: Generated by available_energy_model.py
! Date: 2026-02-08
! =============================================================================

module ae_seasonal_model

    use types, only: r_8
    implicit none
    private

    ! Public interface
    public :: available_energy_global
    public :: available_energy_monthly
    public :: available_energy_daily
    public :: available_energy_t_rh_p

    ! Global model coefficients
    real(r_8), parameter :: GLOBAL_SLOPE = 0.55977546_r_8
    real(r_8), parameter :: GLOBAL_INTERCEPT = 123.06305814_r_8

    ! Monthly model coefficients (12 months)
    real(r_8), parameter :: MONTHLY_SLOPES(12) = (/ &
        -2.108450_r_8, -1.437247_r_8, -0.588499_r_8, 0.236902_r_8, &
        1.639078_r_8, 2.409190_r_8, 2.227970_r_8, 1.019058_r_8, &
        -0.026621_r_8, -0.437629_r_8, -1.331796_r_8, -1.926650_r_8 /)

    real(r_8), parameter :: MONTHLY_INTERCEPTS(12) = (/ &
        192.789537_r_8, 177.914943_r_8, 154.974052_r_8, 127.106837_r_8, &
        84.425292_r_8, 63.037193_r_8, 70.980685_r_8, 109.282217_r_8, &
        143.811683_r_8, 157.014736_r_8, 175.584722_r_8, 187.398894_r_8 /)

    ! Daily model coefficients (365 days)
    real(r_8), parameter :: DAILY_SLOPES(365) = (/ &
        -2.146303_r_8, -2.093235_r_8, -2.036706_r_8, -2.128316_r_8, -1.908139_r_8, -2.039230_r_8, -2.197431_r_8, &
        -2.268322_r_8, -2.102777_r_8, -2.093860_r_8, -2.252162_r_8, -2.393061_r_8, -2.282845_r_8, -2.354113_r_8, &
        -2.418467_r_8, -2.052881_r_8, -2.188246_r_8, -2.212980_r_8, -2.214054_r_8, -2.008293_r_8, -2.113256_r_8, &
        -2.131345_r_8, -2.127755_r_8, -2.027745_r_8, -2.044968_r_8, -1.983086_r_8, -1.929118_r_8, -1.809862_r_8, &
        -1.860686_r_8, -2.027889_r_8, -2.096168_r_8, -2.057421_r_8, -2.071647_r_8, -2.018636_r_8, -1.808501_r_8, &
        -1.686055_r_8, -1.733929_r_8, -1.562151_r_8, -1.675157_r_8, -1.653284_r_8, -1.599499_r_8, -1.505958_r_8, &
        -1.608886_r_8, -1.373269_r_8, -1.251062_r_8, -1.155559_r_8, -1.242124_r_8, -1.357516_r_8, -1.320084_r_8, &
        -1.282041_r_8, -1.163602_r_8, -1.208901_r_8, -1.222398_r_8, -1.110593_r_8, -1.277552_r_8, -1.198654_r_8, &
        -1.190304_r_8, -1.028149_r_8, -1.084948_r_8, -0.945747_r_8, -1.152778_r_8, -0.958083_r_8, -0.892223_r_8, &
        -1.110034_r_8, -0.996897_r_8, -0.836848_r_8, -1.075557_r_8, -1.002754_r_8, -1.009479_r_8, -0.963231_r_8, &
        -0.903388_r_8, -0.832172_r_8, -0.711960_r_8, -0.621787_r_8, -0.519525_r_8, -0.421297_r_8, -0.411511_r_8, &
        -0.591693_r_8, -0.511860_r_8, -0.307899_r_8, -0.296017_r_8, -0.286380_r_8, -0.353268_r_8, -0.261950_r_8, &
        -0.234994_r_8, -0.003185_r_8, -0.090188_r_8, -0.208523_r_8, -0.238183_r_8, -0.080432_r_8, -0.062923_r_8, &
        0.012853_r_8, -0.121971_r_8, -0.210702_r_8, -0.073660_r_8, -0.232846_r_8, -0.148168_r_8, 0.065447_r_8, &
        -0.007869_r_8, 0.065342_r_8, 0.003709_r_8, -0.061314_r_8, -0.010577_r_8, 0.013663_r_8, 0.030947_r_8, &
        0.141294_r_8, 0.165514_r_8, 0.286146_r_8, 0.274125_r_8, 0.239731_r_8, 0.274676_r_8, 0.208349_r_8, &
        0.449258_r_8, 0.532118_r_8, 0.543925_r_8, 0.568350_r_8, 0.760869_r_8, 0.565413_r_8, 0.809011_r_8, &
        0.829176_r_8, 0.770007_r_8, 0.644655_r_8, 0.858359_r_8, 0.995088_r_8, 1.006798_r_8, 0.897786_r_8, &
        1.080813_r_8, 1.224764_r_8, 1.359578_r_8, 1.359678_r_8, 1.551554_r_8, 1.527821_r_8, 1.522369_r_8, &
        1.719413_r_8, 1.759552_r_8, 1.718325_r_8, 1.694228_r_8, 1.862796_r_8, 1.736759_r_8, 1.681263_r_8, &
        1.801179_r_8, 1.875419_r_8, 2.064204_r_8, 2.064304_r_8, 2.079506_r_8, 2.045440_r_8, 2.006558_r_8, &
        2.132259_r_8, 2.088803_r_8, 2.020235_r_8, 2.154239_r_8, 2.248661_r_8, 2.165869_r_8, 2.231700_r_8, &
        2.398181_r_8, 2.453874_r_8, 2.329300_r_8, 2.378061_r_8, 2.287576_r_8, 2.422373_r_8, 2.509591_r_8, &
        2.265282_r_8, 2.328349_r_8, 2.378516_r_8, 2.326042_r_8, 2.367014_r_8, 2.446696_r_8, 2.408307_r_8, &
        2.398330_r_8, 2.430344_r_8, 2.478944_r_8, 2.563454_r_8, 2.392254_r_8, 2.433573_r_8, 2.391173_r_8, &
        2.379289_r_8, 2.494503_r_8, 2.552185_r_8, 2.612209_r_8, 2.614747_r_8, 2.523302_r_8, 2.338008_r_8, &
        2.402857_r_8, 2.227237_r_8, 2.259484_r_8, 2.310356_r_8, 2.292313_r_8, 2.451318_r_8, 2.480629_r_8, &
        2.304113_r_8, 2.235514_r_8, 2.315492_r_8, 2.413250_r_8, 2.399815_r_8, 2.298591_r_8, 2.172332_r_8, &
        2.173868_r_8, 2.238013_r_8, 2.385336_r_8, 2.284238_r_8, 2.247391_r_8, 2.076960_r_8, 2.155924_r_8, &
        2.187735_r_8, 2.235558_r_8, 2.265313_r_8, 2.085164_r_8, 2.007442_r_8, 1.890167_r_8, 1.737667_r_8, &
        1.710349_r_8, 1.664683_r_8, 1.606670_r_8, 1.826243_r_8, 1.700114_r_8, 1.519445_r_8, 1.504314_r_8, &
        1.555569_r_8, 1.418581_r_8, 1.329411_r_8, 1.333783_r_8, 1.597178_r_8, 1.353823_r_8, 1.167980_r_8, &
        0.991660_r_8, 1.203933_r_8, 1.074018_r_8, 0.950548_r_8, 0.925182_r_8, 0.783293_r_8, 0.673649_r_8, &
        0.785544_r_8, 0.885879_r_8, 0.782690_r_8, 0.591564_r_8, 0.519542_r_8, 0.455912_r_8, 0.315276_r_8, &
        0.275696_r_8, 0.289256_r_8, 0.238762_r_8, 0.081908_r_8, 0.170795_r_8, 0.097406_r_8, 0.070685_r_8, &
        0.200587_r_8, 0.392561_r_8, 0.271749_r_8, 0.257812_r_8, 0.254218_r_8, 0.243643_r_8, 0.128044_r_8, &
        0.102576_r_8, 0.029368_r_8, 0.079295_r_8, 0.004776_r_8, -0.177620_r_8, -0.153147_r_8, -0.071738_r_8, &
        -0.179981_r_8, -0.200591_r_8, -0.216115_r_8, -0.134692_r_8, -0.076519_r_8, -0.358306_r_8, -0.011448_r_8, &
        -0.083624_r_8, -0.338383_r_8, -0.208687_r_8, -0.087944_r_8, -0.113324_r_8, -0.434209_r_8, -0.512913_r_8, &
        -0.556810_r_8, -0.465729_r_8, -0.392485_r_8, -0.287613_r_8, -0.323834_r_8, -0.214060_r_8, -0.009604_r_8, &
        -0.095421_r_8, -0.178989_r_8, -0.330766_r_8, -0.204129_r_8, -0.247806_r_8, -0.223388_r_8, -0.075338_r_8, &
        -0.218838_r_8, -0.329759_r_8, -0.512455_r_8, -0.601848_r_8, -0.648145_r_8, -0.548370_r_8, -0.592504_r_8, &
        -0.518863_r_8, -0.354701_r_8, -0.620711_r_8, -0.640997_r_8, -0.807558_r_8, -0.750303_r_8, -0.609885_r_8, &
        -0.874394_r_8, -0.918043_r_8, -1.029049_r_8, -1.023386_r_8, -0.980118_r_8, -1.198837_r_8, -1.237824_r_8, &
        -1.113654_r_8, -1.062711_r_8, -1.204110_r_8, -1.091546_r_8, -1.243798_r_8, -1.086553_r_8, -1.056994_r_8, &
        -1.065134_r_8, -1.196389_r_8, -1.229591_r_8, -1.368813_r_8, -1.498049_r_8, -1.348561_r_8, -1.185030_r_8, &
        -1.358095_r_8, -1.550776_r_8, -1.545269_r_8, -1.389623_r_8, -1.570928_r_8, -1.445759_r_8, -1.529808_r_8, &
        -1.804730_r_8, -1.776236_r_8, -1.636501_r_8, -1.631811_r_8, -1.747986_r_8, -1.712159_r_8, -1.802522_r_8, &
        -1.771700_r_8, -1.734432_r_8, -1.359508_r_8, -1.585308_r_8, -1.647264_r_8, -1.521875_r_8, -1.897755_r_8, &
        -1.779241_r_8, -1.937017_r_8, -1.904005_r_8, -1.954800_r_8, -2.183486_r_8, -2.004029_r_8, -2.163120_r_8, &
        -2.129402_r_8, -2.174596_r_8, -2.049260_r_8, -2.095208_r_8, -2.155282_r_8, -2.249685_r_8, -2.230117_r_8, &
        -2.152335_r_8, -2.250044_r_8, -1.856468_r_8, -1.945041_r_8, -1.925690_r_8, -1.901399_r_8, -1.905064_r_8, &
        -2.062689_r_8 /)

    real(r_8), parameter :: DAILY_INTERCEPTS(365) = (/ &
        192.663494_r_8, 191.686794_r_8, 190.449176_r_8, 192.817545_r_8, 187.738845_r_8, 190.636496_r_8, 193.531688_r_8, &
        195.388433_r_8, 192.067261_r_8, 191.827575_r_8, 195.514909_r_8, 197.079834_r_8, 195.453975_r_8, 196.247766_r_8, &
        197.356430_r_8, 190.037591_r_8, 193.437777_r_8, 195.532088_r_8, 195.565831_r_8, 190.701205_r_8, 194.114657_r_8, &
        194.460997_r_8, 194.566555_r_8, 193.580397_r_8, 192.922426_r_8, 191.955758_r_8, 190.550893_r_8, 187.970782_r_8, &
        189.083143_r_8, 191.886583_r_8, 193.612139_r_8, 191.775577_r_8, 192.698338_r_8, 191.909080_r_8, 187.632610_r_8, &
        183.985827_r_8, 185.810109_r_8, 182.386691_r_8, 183.810743_r_8, 182.423269_r_8, 182.265869_r_8, 179.717208_r_8, &
        181.483840_r_8, 176.719072_r_8, 174.669210_r_8, 173.220753_r_8, 174.536256_r_8, 176.637245_r_8, 174.845563_r_8, &
        174.067194_r_8, 170.775356_r_8, 171.013577_r_8, 170.975268_r_8, 169.232148_r_8, 173.408164_r_8, 171.461383_r_8, &
        171.757469_r_8, 167.734447_r_8, 169.370171_r_8, 166.840423_r_8, 171.579168_r_8, 166.803315_r_8, 164.504913_r_8, &
        169.493424_r_8, 166.764589_r_8, 163.929593_r_8, 169.524115_r_8, 168.065226_r_8, 166.950039_r_8, 165.561728_r_8, &
        163.564390_r_8, 162.418965_r_8, 158.287388_r_8, 156.095972_r_8, 153.077628_r_8, 150.946508_r_8, 150.214506_r_8, &
        154.184701_r_8, 150.989666_r_8, 146.105152_r_8, 146.155399_r_8, 145.661575_r_8, 146.889341_r_8, 146.103636_r_8, &
        143.405809_r_8, 138.857279_r_8, 140.502673_r_8, 142.889720_r_8, 142.116671_r_8, 139.599085_r_8, 139.313030_r_8, &
        137.695133_r_8, 140.852598_r_8, 142.411673_r_8, 139.086976_r_8, 142.039054_r_8, 140.236954_r_8, 134.407826_r_8, &
        135.220624_r_8, 133.728255_r_8, 134.296914_r_8, 134.049276_r_8, 132.339963_r_8, 130.666167_r_8, 130.457745_r_8, &
        128.894910_r_8, 126.994771_r_8, 123.863413_r_8, 124.929443_r_8, 125.575396_r_8, 124.400127_r_8, 125.684901_r_8, &
        120.225601_r_8, 117.726445_r_8, 116.493664_r_8, 115.653211_r_8, 111.179686_r_8, 115.311117_r_8, 108.440237_r_8, &
        109.149458_r_8, 109.118497_r_8, 112.044850_r_8, 106.965294_r_8, 102.907120_r_8, 101.967194_r_8, 103.326385_r_8, &
        99.304059_r_8, 95.125083_r_8, 93.912911_r_8, 94.111471_r_8, 89.885540_r_8, 89.524662_r_8, 89.190327_r_8, &
        83.463681_r_8, 82.010672_r_8, 82.482922_r_8, 82.066940_r_8, 77.608084_r_8, 79.441895_r_8, 80.516503_r_8, &
        78.038340_r_8, 76.902978_r_8, 72.070381_r_8, 71.729396_r_8, 71.964028_r_8, 72.955631_r_8, 73.328585_r_8, &
        70.222694_r_8, 70.839855_r_8, 71.239170_r_8, 67.665604_r_8, 65.578243_r_8, 68.245507_r_8, 66.906755_r_8, &
        63.869568_r_8, 63.851084_r_8, 65.716321_r_8, 64.368864_r_8, 65.804645_r_8, 62.110224_r_8, 61.342153_r_8, &
        66.933762_r_8, 65.386402_r_8, 64.010566_r_8, 65.102149_r_8, 64.607423_r_8, 62.526939_r_8, 63.465685_r_8, &
        62.182833_r_8, 61.320581_r_8, 61.148076_r_8, 59.448327_r_8, 63.210840_r_8, 62.918926_r_8, 62.662947_r_8, &
        62.091394_r_8, 60.841013_r_8, 59.898524_r_8, 57.678575_r_8, 58.290500_r_8, 61.181899_r_8, 65.120331_r_8, &
        63.954878_r_8, 66.724627_r_8, 65.233015_r_8, 64.476324_r_8, 65.077587_r_8, 62.274772_r_8, 62.341554_r_8, &
        67.148625_r_8, 69.058014_r_8, 67.019617_r_8, 65.158648_r_8, 65.645566_r_8, 69.064599_r_8, 71.414257_r_8, &
        70.490576_r_8, 70.157790_r_8, 67.920555_r_8, 71.040707_r_8, 72.783173_r_8, 76.469198_r_8, 73.792114_r_8, &
        73.724828_r_8, 73.630167_r_8, 73.843766_r_8, 78.668840_r_8, 80.714295_r_8, 83.871338_r_8, 86.657067_r_8, &
        86.829324_r_8, 89.331563_r_8, 91.186766_r_8, 86.798313_r_8, 89.359460_r_8, 95.097948_r_8, 95.499096_r_8, &
        94.852115_r_8, 97.731617_r_8, 98.551986_r_8, 97.261293_r_8, 92.204608_r_8, 99.030081_r_8, 104.824055_r_8, &
        108.226539_r_8, 103.852448_r_8, 107.158436_r_8, 110.294937_r_8, 111.382222_r_8, 115.024919_r_8, 118.433561_r_8, &
        116.675356_r_8, 114.048260_r_8, 117.515999_r_8, 122.872498_r_8, 125.324852_r_8, 126.579866_r_8, 129.237781_r_8, &
        130.196631_r_8, 129.725223_r_8, 132.236694_r_8, 136.304430_r_8, 134.885458_r_8, 136.350756_r_8, 136.589268_r_8, &
        134.055697_r_8, 130.256263_r_8, 135.652066_r_8, 136.061567_r_8, 137.800517_r_8, 137.587666_r_8, 139.014546_r_8, &
        140.140680_r_8, 141.742424_r_8, 140.436156_r_8, 143.607388_r_8, 147.317677_r_8, 146.385942_r_8, 144.247449_r_8, &
        147.819293_r_8, 148.768824_r_8, 149.674341_r_8, 147.559275_r_8, 146.455907_r_8, 154.041562_r_8, 145.837151_r_8, &
        145.564646_r_8, 152.432754_r_8, 149.253843_r_8, 147.586756_r_8, 148.487335_r_8, 156.128806_r_8, 158.186452_r_8, &
        159.915449_r_8, 157.727578_r_8, 155.933590_r_8, 154.682814_r_8, 155.087389_r_8, 151.647923_r_8, 147.024537_r_8, &
        149.207336_r_8, 151.786583_r_8, 155.210403_r_8, 151.612738_r_8, 151.545454_r_8, 152.417936_r_8, 148.869774_r_8, &
        152.013312_r_8, 156.020589_r_8, 158.711924_r_8, 160.063712_r_8, 161.653677_r_8, 159.483005_r_8, 159.775630_r_8, &
        158.823137_r_8, 155.086059_r_8, 161.290757_r_8, 162.447313_r_8, 167.294661_r_8, 164.559931_r_8, 162.049344_r_8, &
        166.727585_r_8, 165.374310_r_8, 167.018312_r_8, 168.875490_r_8, 168.795186_r_8, 173.950780_r_8, 174.145635_r_8, &
        171.572765_r_8, 171.022013_r_8, 173.300049_r_8, 171.285876_r_8, 174.735686_r_8, 169.714468_r_8, 169.247733_r_8, &
        169.576413_r_8, 172.505255_r_8, 172.461201_r_8, 175.372782_r_8, 178.109452_r_8, 175.388014_r_8, 171.850686_r_8, &
        175.798925_r_8, 180.786960_r_8, 180.459945_r_8, 175.799568_r_8, 180.282167_r_8, 177.714399_r_8, 180.315391_r_8, &
        185.567592_r_8, 185.328385_r_8, 182.192194_r_8, 181.794940_r_8, 184.308592_r_8, 183.056745_r_8, 185.067550_r_8, &
        185.293568_r_8, 184.180907_r_8, 175.124784_r_8, 179.153697_r_8, 180.574131_r_8, 177.591225_r_8, 186.548811_r_8, &
        184.450115_r_8, 188.478215_r_8, 187.172559_r_8, 187.639771_r_8, 193.061745_r_8, 189.212809_r_8, 193.260916_r_8, &
        191.889014_r_8, 192.954266_r_8, 190.346169_r_8, 191.423074_r_8, 192.216527_r_8, 194.077187_r_8, 194.552556_r_8, &
        192.459039_r_8, 194.123177_r_8, 185.016796_r_8, 187.234334_r_8, 187.422981_r_8, 186.314078_r_8, 186.269694_r_8, &
        189.959938_r_8 /)


    ! Multivariate model coefficients (best model: T_RH_P)
    real(r_8), parameter :: MV_T_COEF = 8.71606636_r_8
    real(r_8), parameter :: MV_RH_COEF = 0.82899487_r_8
    real(r_8), parameter :: MV_P_COEF = -0.55874598_r_8
    real(r_8), parameter :: MV_INTERCEPT = 401.13562012_r_8

contains

    !> Calculate available energy using global linear model
    !>
    !> @param[in] temp  Air temperature (degrees Celsius)
    !> @return    ae    Available energy (W/m²)
    pure function available_energy_global(temp) result(ae)
        real(r_8), intent(in) :: temp
        real(r_8) :: ae

        ae = GLOBAL_SLOPE * temp + GLOBAL_INTERCEPT

    end function available_energy_global


    !> Calculate available energy using monthly seasonal model
    !>
    !> @param[in] temp   Air temperature (degrees Celsius)
    !> @param[in] month  Month of year (1-12)
    !> @return    ae     Available energy (W/m²)
    pure function available_energy_monthly(temp, month) result(ae)
        real(r_8), intent(in) :: temp
        integer, intent(in) :: month
        real(r_8) :: ae
        integer :: m

        ! Clamp month to valid range [1, 12]
        m = max(1, min(12, month))

        ae = MONTHLY_SLOPES(m) * temp + MONTHLY_INTERCEPTS(m)

    end function available_energy_monthly


    !> Calculate available energy using daily seasonal model
    !>
    !> @param[in] temp  Air temperature (degrees Celsius)
    !> @param[in] doy   Day of year (1-365; leap day 366 maps to 365)
    !> @return    ae    Available energy (W/m²)
    pure function available_energy_daily(temp, doy) result(ae)
        real(r_8), intent(in) :: temp
        integer, intent(in) :: doy
        real(r_8) :: ae
        integer :: d

        ! Clamp day to valid range [1, 365]
        ! Note: Leap year day 366 is treated as day 365
        d = max(1, min(365, doy))

        ae = DAILY_SLOPES(d) * temp + DAILY_INTERCEPTS(d)

    end function available_energy_daily



    !> Calculate available energy using multivariate model (T_RH_P)
    !>
    !> Best model: R² = 0.5136
    !>
    !> @param[in] temp  Air temperature (degrees Celsius)
    !> @param[in] rh    Relative humidity (%)
    !> @param[in] pres  Surface pressure (Pa)
    !> @return    ae    Available energy (W/m²)
    pure function available_energy_t_rh_p(temp, rh, pres) result(ae)
        real(r_8), intent(in) :: temp, rh, pres
        real(r_8) :: ae

        ae = MV_T_COEF * temp + MV_RH_COEF * rh + MV_P_COEF * pres + MV_INTERCEPT

    end function available_energy_t_rh_p

end module ae_seasonal_model
